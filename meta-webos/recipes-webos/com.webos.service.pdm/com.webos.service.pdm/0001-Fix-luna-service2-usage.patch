From 0384201a471fbdd31dfef84c256a3027b52fafb7 Mon Sep 17 00:00:00 2001
From: Martin Jansa <martin2.jansa@lgepartner.com>
Date: Mon, 20 Mar 2023 23:14:01 +0000
Subject: [PATCH] Fix luna-service2 usage

:Release Notes:
Since luna-service2 submission 143 from September 2012 ls2 headers
should be included from luna-service2 directory.

:Detailed Notes:
Fixes:

FAILED: CMakeFiles/physical-device-manager.dir/src/devices/sound/SoundDevice.cpp.o
TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot-native/usr/bin/x86_64-webos-linux/x86_64-webos-linux-g++  -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc/private -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc/public -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/lib/glib-2.0/include -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/include/libusb-1.0 -m64 -march=core2 -mtune=core2 -msse3 -mfpmath=sse -fstack-protector-strong  -O2 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -Werror=return-type  --sysroot=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot  -O2 -pipe -g -feliminate-unused-debug-types -fmacro-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6=/usr/src/debug/com.webos.service.pdm/1.0.1-79-r6                      -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6=/usr/src/debug/com.webos.service.pdm/1.0.1-79-r6                      -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot=                      -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot-native=  -fvisibility-inlines-hidden  -std=c++14 -Wall -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/lib/glib-2.0/include -DUSE_PMLOG_DECLARATION -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/lib/glib-2.0/include -DUSE_PMLOG_DECLARATION -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/recipe-sysroot/usr/lib/glib-2.0/include -include TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/build/Configured/webospaths.h -DNDEBUG -MD -MT CMakeFiles/physical-device-manager.dir/src/devices/sound/SoundDevice.cpp.o -MF CMakeFiles/physical-device-manager.dir/src/devices/sound/SoundDevice.cpp.o.d -o CMakeFiles/physical-device-manager.dir/src/devices/sound/SoundDevice.cpp.o -c TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/src/devices/sound/SoundDevice.cpp
In file included from TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc/public/Plugin-Api.h:22,
                 from TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc/private/PluginAdapter.h:20,
                 from TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc/private/Device.h:25,
                 from TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc/private/SoundDevice.h:21,
                 from TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/src/devices/sound/SoundDevice.cpp:17:
TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.pdm/1.0.1-79-r6/git/inc/public/pdm-plugin/PluginBase.h:21:10: fatal error: lunaservice.h: No such file or directory
   21 | #include <lunaservice.h>
      |          ^~~~~~~~~~~~~~~
compilation terminated.

:Testing Performed:
Only build tested.

:QA Notes:
No change to image.

:Issues Addressed:
[WRP-10642] Remove the temporary work around from 2012 from luna-service2 recipe
[WRP-11674] com.webos.service.pdm: Fix luna-service2 usage
[WRP-10791] CCC: Various build fixes

Change-Id: I1bf2f462e4956bbab90121a958abc872ed1b6ec3
---
Upstream-Status: Submitted [http://gpro.lge.com/c/webosose/com.webos.service.pdm/+/348182 Fix luna-service2 usage]

 inc/private/JsonUtils.h            | 2 +-
 inc/private/PdmLocaleHandler.h     | 2 +-
 inc/private/PdmLunaHandler.h       | 2 +-
 inc/private/PdmLunaService.h       | 1 -
 inc/private/PdmNotification.h      | 2 +-
 inc/public/pdm-plugin/PluginBase.h | 2 +-
 6 files changed, 5 insertions(+), 6 deletions(-)

diff --git a/inc/private/JsonUtils.h b/inc/private/JsonUtils.h
index ecb0936..63b655a 100644
--- a/inc/private/JsonUtils.h
+++ b/inc/private/JsonUtils.h
@@ -17,7 +17,7 @@
 #ifndef JSONUTILS_H
 #define JSONUTILS_H
 
-#include <lunaservice.h>
+#include <luna-service2/lunaservice.h>
 #include <pbnjson.hpp>
 
 #define SCHEMA_V2_PROP(name, type, ...)                  "\"" #name "\":{\"type\":\"" #type "\"" __VA_ARGS__ "}"
diff --git a/inc/private/PdmLocaleHandler.h b/inc/private/PdmLocaleHandler.h
index dcdef1e..3a5b28d 100644
--- a/inc/private/PdmLocaleHandler.h
+++ b/inc/private/PdmLocaleHandler.h
@@ -17,7 +17,7 @@
 #ifndef _PDMLOCALEHANDLER_H
 #define _PDMLOCALEHANDLER_H
 
-#include <lunaservice.h>
+#include <luna-service2/lunaservice.h>
 #include <webosi18n.h>
 
 class PdmLocaleHandler
diff --git a/inc/private/PdmLunaHandler.h b/inc/private/PdmLunaHandler.h
index 10f6118..073b297 100644
--- a/inc/private/PdmLunaHandler.h
+++ b/inc/private/PdmLunaHandler.h
@@ -21,7 +21,7 @@
 #include <unordered_map>
 #include <string>
 #include <list>
-#include <lunaservice.h>
+#include <luna-service2/lunaservice.h>
 
 #include "pbnjson.hpp"
 
diff --git a/inc/private/PdmLunaService.h b/inc/private/PdmLunaService.h
index ca6ad7d..4c3a29f 100644
--- a/inc/private/PdmLunaService.h
+++ b/inc/private/PdmLunaService.h
@@ -20,7 +20,6 @@
 #include <map>
 #include <string>
 #include <glib.h>
-#include <lunaservice.h>
 #include <luna-service2++/handle.hpp>
 #include <luna-service2/lunaservice.hpp>
 
diff --git a/inc/private/PdmNotification.h b/inc/private/PdmNotification.h
index 4c410fa..e74f0d1 100644
--- a/inc/private/PdmNotification.h
+++ b/inc/private/PdmNotification.h
@@ -17,7 +17,7 @@
 #ifndef _NOTIFICATION_MGR_H_
 #define _NOTIFICATION_MGR_H_
 
-#include <lunaservice.h>
+#include <luna-service2/lunaservice.h>
 #include <string>
 #include <unordered_map>
 #include "PdmNotificationInterface.h"
diff --git a/inc/public/pdm-plugin/PluginBase.h b/inc/public/pdm-plugin/PluginBase.h
index 525c00f..77baf63 100644
--- a/inc/public/pdm-plugin/PluginBase.h
+++ b/inc/public/pdm-plugin/PluginBase.h
@@ -18,7 +18,7 @@
 #define PLUGINBASE_H_
 
 #include "Api.h"
-#include <lunaservice.h>
+#include <luna-service2/lunaservice.h>
 
 #include "IDevice.h"
 
